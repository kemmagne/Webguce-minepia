<ui:composition xmlns:="http://www.w3.org/1999/xhtml"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:ct="http://java.sun.com/jsf/composite/components/ct"
    xmlns:dem="http://java.sun.com/jsf/composite/components/dem"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui"
    xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:wgc="http://java.sun.com/jsf/composite/components/">
    <f:loadBundle basename="org/guce/web/process/dem/util/Bundle" var="dem"/>
    <p:tooltip for=":formContenu"/>
    <h:form id="formContenu">
        <ui:insert name="action"/>
        <p:messages id="messages"/>
        <p:tabView effect="slide" id="allcontent" rendered="#{demController.current != null}">
            
            <p:tab title="#{dem.generalInfo}">
                <p:outputLabel rendered="#{demController.current.recordId != null}">
                    <h3 class="webguce-block-title">#{dem.reference}</h3>
                </p:outputLabel>
                <dem:reference id="reference" readOnly="true"
                    rendered="#{demController.current.recordId != null}"
                    styleClass="webguce-sub-block" value="#{demController.current}"/>
                <h3 class="webguce-block-title">#{dem.registration}</h3>
                <dem:registration id="registration" readOnly="true"
                    readOnlyList="" rendered="true"
                    renderedList="#{demController.current.demReference != null ? '':'demDate,demReference'}"
                    required="true" styleClass="webguce-sub-block" value="#{demController.current}"/>
                <p:outputPanel id="informationBlock">
                    <h3 class="webguce-sub-block-title">#{dem.information}</h3>
                    <dem:information id="information" readOnly="true"
                        readOnlyList=""
                        rendered="#{demController.compute_information()}"
                        renderedList="" required="true" requiredList=""
                        styleClass="webguce-sub-block" value="#{demController.current.information}"/>
                </p:outputPanel>
            </p:tab>
           
            <p:tab id="invoicesBlock"
                rendered="#{demController.current.invoiceList.size() > 0}" title="#{dem.invoices}">
                <dem:invoices id="invoices" readonly="true" value="#{demController.current.invoiceList}"/>
            </p:tab>
            <p:tab id="decisionBlock"
                rendered="#{demController.processing != null}" title="#{dem.decision}">
                <dem:decision id="decision" readonly="true" value="#{demController.processing}"/>
            </p:tab>
            <p:tab id="attachmentBlock" title="#{dem.attachments}">
                <wgc:attachments
                    avaibleAttachmentType="#{demController.avaibleAttachmentType}"
                    id="attachment"
                    parentClass="#{demController.current}"
                    readonly="true" styleClass="pm2" type="view" value="#{demController.current.coreAttachmentList}"/>
            </p:tab>
        </p:tabView>
    </h:form>
    <p:ajaxStatus id="myajaxStatus" oncomplete="myReadonly()"/>
    <script>
        function myReadonly() {
            jQuery('.my-readonly').attr("readonly", "readonly");
        }
        myReadonly();
    </script>
    <style>
        .blockTitle{
            border-bottom :solid 1px #DDD;border-top :solid 1px #DDD;margin:10px 0px;padding:5px 0px;
        }
    </style>
</ui:composition>
